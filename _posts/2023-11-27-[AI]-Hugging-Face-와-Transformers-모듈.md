---
layout: post
date: 2023-11-27
title: "[AI] Hugging Face ì™€ Transformers ëª¨ë“ˆ"
tags: [Python, ]
categories: [AI, ]
---

# ğŸ§  ê°œìš”


LLM(Large Language Model)ì´ ìœ í–‰í•˜ê³  ìˆëŠ” ì§€ê¸ˆ ì¸ê³µì§€ëŠ¥ì— ëŒ€í•œ ê¸°ëŒ€ëŠ” ë§¤ìš° ë†’ë‹¤. ê·¸ë ‡ê¸°ì— ìš”ì¦˜ Transformer ë¼ëŠ” ëª¨ë“ˆì„ ìì£¼ ë³´ê²Œ ëœë‹¤. ê·¸ë ‡ë‹¤ë©´ Transformerë¼ëŠ” ëª¨ë“ˆì´ ë¬´ì—‡ì´ê³ , ì´ Transformerë¼ëŠ” ëª¨ë“ˆì„ ë§Œë“  huggingfaceëŠ” ì–´ë–¤ ì—­í• ì„ í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.


# ğŸ§  Hugging Face


í—ˆê¹…í˜ì´ìŠ¤ëŠ” íŠ¸ëœìŠ¤í¬ë¨¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ë‹¤ì–‘í•œ ëª¨ë¸(_transformer.models_)ê³¼ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸(_transformer.Trainer_)ë¥¼ ì œê³µí•˜ëŠ” ëª¨ë“ˆì´ë‹¤.


ì´ í—ˆê¹…í˜ì´ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ë‹¤ì–‘í•œ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì„ ì†ì‰½ê²Œ ì´ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.


ê¸°ì¡´ì—ëŠ” Pytorchë¡œ Layer, model ë“±ì„ ì„ ì–¸ í•´ì£¼ê³  í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë„ ì „ë¶€ êµ¬í˜„ í•´ì•¼í•˜ì§€ë§Œ, í—ˆê¹…í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ê·¸ëŸ° í•¨ìˆ˜ë“¤ì´ ì´ë¯¸ ì •ì˜ ë˜ì–´ìˆê¸° ë•Œë¬¸ì—, ê°„ë‹¨í•˜ê²Œ ëª¨ë¸ë§Œ ë¶ˆëŸ¬ì™€ì„œ argumentsë¥¼ ì¡°ì •í•¨ìœ¼ë¡œì¨ í¸í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.


ë˜, ë‹¤ë¥¸ ëˆ„êµ°ê°€ê°€ ì´ë¯¸ í•™ìŠµí•œ ëª¨ë¸ì„ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆëŠ”ë°, **ëª¨ë¸ ë¿ë§Œ ì•„ë‹ˆë¼ ë°ì´í„°**ë„ ë‹¤ìš´ ë°›ì„ ìˆ˜ ìˆë‹¤.


> [https://huggingface.co/](https://huggingface.co/)


![0](/assets/img/2023-11-27-[AI]-Hugging-Face-ì™€-Transformers-ëª¨ë“ˆ.md/0.png)


í•˜ì§€ë§Œ ì´ë¯¸ ë‹¤ ëª¨ë“ˆí™”ê°€ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì»¤ìŠ¤í„° ë§ˆì´ì§• í•˜ê¸° ì–´ë ¤ìš´ ì ì´ ìˆë‹¤.


# ğŸ§  Transformer


íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” CNN, RNNê³¼ ê°™ì´ ì¸ê³µì§€ëŠ¥ ë¶„ì•¼ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë¸ì´ë‹¤.
íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì€ ë¬¸ì¥ ì† ë‹¨ì–´ì™€ ê°™ì€ ìˆœì°¨ ë°ì´í„° ë‚´ì˜ ê´€ê³„ë¥¼ ì¶”ì í•´ ë§¥ë½ê³¼ ì˜ë¯¸ë¥¼ í•™ìŠµí•˜ëŠ” ì‹ ê²½ë§ì´ë‹¤. â€˜Self-attentionâ€™ì„ ì‚¬ìš©í•œ ì–¸ì–´ ëª¨ë¸ì¸ë°, í˜„ì¬ ì–¸ì–´ ë¿ë§Œ ì•„ë‹ˆë¼ ì´ë¯¸ì§€, ì˜ìƒì—ë„ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ë˜ê³  ìˆë‹¤.


ì—¬ê¸°ì„œ Self-attentionì€ ì§„í™”ë¥¼ ê±°ë“­í•˜ëŠ” ìˆ˜í•™ì  ê¸°ë²•ì„ ì‘ìš©í•´ ì„œë¡œ ë–¨ì–´ì ¸ ìˆëŠ” ë°ì´í„° ìš”ì†Œë“¤ì˜ ì˜ë¯¸ê°€ ê´€ê³„ì— ë”°ë¼ ë¯¸ë¬˜í•˜ê²Œ ë‹¬ë¼ì§€ëŠ” ë¶€ë¶„ê¹Œì§€ ê°ì§€í•œë‹¤.


## ğŸ¦¾ transformers.models


íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ì˜ ë‹¤ì–‘í•œ ëª¨ë¸ì„ íŒŒì´í† ì¹˜, í…ì„œ í”Œë¡œìš°ë¡œ ê°ê° êµ¬í˜„ í•´ë†“ì€ ëª¨ë“ˆì´ë‹¤. ë˜í•œ ê° ëª¨ë¸ì— ë§ëŠ” tokenizerë„ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

- tokenizerë€? ì…ë ¥ëœ í…ìŠ¤íŠ¸ë¥¼ ëª¨ë¸ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¡œ ë³€í™˜í•´ì£¼ëŠ” ê²ƒì´ë¼ í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê³µë°± ë‹¨ìœ„ë¡œ ë¬¸ì¥ì„ ë¶„ì ˆ í•˜ê±°ë‚˜, ë‹¨ì–´ ë‹¨ìœ„ë¡œ ë¬¸ì¥ì„ ë¶„ì ˆ í•˜ëŠ” ë°©ì‹ì„ tokenizerë¼ í•  ìˆ˜ ìˆë‹¤.

## ğŸ¦¾ transformers.Trainer


ë”¥ëŸ¬ë‹ í•™ìŠµ ë° í‰ê°€ì— í•„ìš”í•œ optimizer, weight updt, learning rate schedul, ckpt, tensorbord, evaluation ë“±ì„ ìˆ˜í–‰í•œë‹¤. Trainer.train í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì´ ëª¨ë“  ê³¼ì •ì´ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” argumentsì— ë§ê²Œ ì‹¤í–‰ëœë‹¤.


# ğŸ§  ì˜ˆì œ

1. transformers ì„¤ì¹˜

> pip install transformers


ì„¤ì¹˜ ë„ì¤‘ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤..


![1](/assets/img/2023-11-27-[AI]-Hugging-Face-ì™€-Transformers-ëª¨ë“ˆ.md/1.png)


ì•„ë§ˆ ìœˆë„ìš°ì˜ í´ë” ì´ë¦„ ê¸¸ì´ì¸ 256ë¥¼ ë„˜ì–´ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë°, ì´ ë¬¸ì œëŠ” ë‹¤ìŒê³¼ ê°™ì´ í•´ê²° í•˜ì˜€ë‹¤.


[embed](https://dhniyeo.github.io/trouble%20shoot/2023/11/27/TroubleShoot-VisualStudio-Code-Tensorflow-%EC%84%A4%EC%B9%98-%EC%98%A4%EB%A5%98-(%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%8F%B4%EB%8D%94-%EC%9D%B4%EB%A6%84-%EA%B8%B8%EC%9D%B4-256-%EC%B4%88%EA%B3%BC-%EB%AC%B8%EC%A0%9C)/)


[https://dhniyeo.github.io/trouble shoot/2023/11/27/TroubleShoot-VisualStudio-Code-Tensorflow-ì„¤ì¹˜-ì˜¤ë¥˜-(ìœˆë„ìš°-í´ë”-ì´ë¦„-ê¸¸ì´-256-ì´ˆê³¼-ë¬¸ì œ)/](https://dhniyeo.github.io/trouble%20shoot/2023/11/27/TroubleShoot-VisualStudio-Code-Tensorflow-%EC%84%A4%EC%B9%98-%EC%98%A4%EB%A5%98-(%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%8F%B4%EB%8D%94-%EC%9D%B4%EB%A6%84-%EA%B8%B8%EC%9D%B4-256-%EC%B4%88%EA%B3%BC-%EB%AC%B8%EC%A0%9C)/)

1. transformersì—ì„œ tokenizer, model ë¶ˆëŸ¬ì˜¤ê¸°
1. ë¶ˆëŸ¬ì˜¨ tokenizer, model ì‚¬ìš©í•˜ê¸°
