---
layout: post
date: 2023-11-26
title: "[AI] Hugging Face ì™€ Transformers ëª¨ë“ˆ"
tags: [Python, AI, ]
categories: [AI, ]
---


## ğŸ§  ê°œìš”


LLM(Large Language Model)ì´ ìœ í–‰í•˜ê³  ìˆëŠ” ì§€ê¸ˆ ì¸ê³µì§€ëŠ¥ì— ëŒ€í•œ ê¸°ëŒ€ëŠ” ë§¤ìš° ë†’ë‹¤. ê·¸ë ‡ê¸°ì— ìš”ì¦˜ Transformer ë¼ëŠ” ëª¨ë“ˆì„ ìì£¼ ë³´ê²Œ ëœë‹¤. ê·¸ë ‡ë‹¤ë©´ Transformerë¼ëŠ” ëª¨ë“ˆì´ ë¬´ì—‡ì´ê³ , ì´ Transformerë¼ëŠ” ëª¨ë“ˆì„ ë§Œë“  huggingfaceëŠ” ì–´ë–¤ ì—­í• ì„ í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.



## ğŸ§  Hugging Face


í—ˆê¹…í˜ì´ìŠ¤ëŠ” íŠ¸ëœìŠ¤í¬ë¨¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ë‹¤ì–‘í•œ ëª¨ë¸(_transformer.models_)ê³¼ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸(_transformer.Trainer_)ë¥¼ ì œê³µí•˜ëŠ” ëª¨ë“ˆì´ë‹¤.


ì´ í—ˆê¹…í˜ì´ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ë‹¤ì–‘í•œ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì„ ì†ì‰½ê²Œ ì´ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.


ê¸°ì¡´ì—ëŠ” Pytorchë¡œ Layer, model ë“±ì„ ì„ ì–¸ í•´ì£¼ê³  í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë„ ì „ë¶€ êµ¬í˜„ í•´ì•¼í•˜ì§€ë§Œ, í—ˆê¹…í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ê·¸ëŸ° í•¨ìˆ˜ë“¤ì´ ì´ë¯¸ ì •ì˜ ë˜ì–´ìˆê¸° ë•Œë¬¸ì—, ê°„ë‹¨í•˜ê²Œ ëª¨ë¸ë§Œ ë¶ˆëŸ¬ì™€ì„œ argumentsë¥¼ ì¡°ì •í•¨ìœ¼ë¡œì¨ í¸í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.


ë˜, ë‹¤ë¥¸ ëˆ„êµ°ê°€ê°€ ì´ë¯¸ í•™ìŠµí•œ ëª¨ë¸ì„ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆëŠ”ë°, **ëª¨ë¸ ë¿ë§Œ ì•„ë‹ˆë¼ ë°ì´í„°**ë„ ë‹¤ìš´ ë°›ì„ ìˆ˜ ìˆë‹¤.


> [https://huggingface.co/](https://huggingface.co/)


![0](/assets/img/2023-11-26-[AI]-Hugging-Face-ì™€-Transformers-ëª¨ë“ˆ.md/0.png)


í•˜ì§€ë§Œ ì´ë¯¸ ë‹¤ ëª¨ë“ˆí™”ê°€ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì»¤ìŠ¤í„° ë§ˆì´ì§• í•˜ê¸° ì–´ë ¤ìš´ ì ì´ ìˆë‹¤.



## ğŸ§  Transformer


íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” CNN, RNNê³¼ ê°™ì´ ì¸ê³µì§€ëŠ¥ ë¶„ì•¼ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë¸ì´ë‹¤.
íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì€ ë¬¸ì¥ ì† ë‹¨ì–´ì™€ ê°™ì€ ìˆœì°¨ ë°ì´í„° ë‚´ì˜ ê´€ê³„ë¥¼ ì¶”ì í•´ ë§¥ë½ê³¼ ì˜ë¯¸ë¥¼ í•™ìŠµí•˜ëŠ” ì‹ ê²½ë§ì´ë‹¤. â€˜Self-attentionâ€™ì„ ì‚¬ìš©í•œ ì–¸ì–´ ëª¨ë¸ì¸ë°, í˜„ì¬ ì–¸ì–´ ë¿ë§Œ ì•„ë‹ˆë¼ ì´ë¯¸ì§€, ì˜ìƒì—ë„ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ë˜ê³  ìˆë‹¤.


ì—¬ê¸°ì„œ Self-attentionì€ ì§„í™”ë¥¼ ê±°ë“­í•˜ëŠ” ìˆ˜í•™ì  ê¸°ë²•ì„ ì‘ìš©í•´ ì„œë¡œ ë–¨ì–´ì ¸ ìˆëŠ” ë°ì´í„° ìš”ì†Œë“¤ì˜ ì˜ë¯¸ê°€ ê´€ê³„ì— ë”°ë¼ ë¯¸ë¬˜í•˜ê²Œ ë‹¬ë¼ì§€ëŠ” ë¶€ë¶„ê¹Œì§€ ê°ì§€í•œë‹¤.



### ğŸ¦¾ transformers.models


íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ì˜ ë‹¤ì–‘í•œ ëª¨ë¸ì„ íŒŒì´í† ì¹˜, í…ì„œ í”Œë¡œìš°ë¡œ ê°ê° êµ¬í˜„ í•´ë†“ì€ ëª¨ë“ˆì´ë‹¤. ë˜í•œ ê° ëª¨ë¸ì— ë§ëŠ” tokenizerë„ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

- tokenizerë€? ì…ë ¥ëœ í…ìŠ¤íŠ¸ë¥¼ ëª¨ë¸ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¡œ ë³€í™˜í•´ì£¼ëŠ” ê²ƒì´ë¼ í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê³µë°± ë‹¨ìœ„ë¡œ ë¬¸ì¥ì„ ë¶„ì ˆ í•˜ê±°ë‚˜, ë‹¨ì–´ ë‹¨ìœ„ë¡œ ë¬¸ì¥ì„ ë¶„ì ˆ í•˜ëŠ” ë°©ì‹ì„ tokenizerë¼ í•  ìˆ˜ ìˆë‹¤.


### ğŸ¦¾ transformers.Trainer


ë”¥ëŸ¬ë‹ í•™ìŠµ ë° í‰ê°€ì— í•„ìš”í•œ optimizer, weight updt, learning rate schedul, ckpt, tensorbord, evaluation ë“±ì„ ìˆ˜í–‰í•œë‹¤. Trainer.train í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì´ ëª¨ë“  ê³¼ì •ì´ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” argumentsì— ë§ê²Œ ì‹¤í–‰ëœë‹¤.



## ğŸ§  ì˜ˆì œ


ê°„ë‹¨í•œ ì˜ˆì œë¥¼ í†µí•´ Transformersì™€ ìµìˆ™í•´ì ¸ ë³´ê¸°ë¡œ í–ˆë‹¤.

1. transformers ì„¤ì¹˜

> pip install transformers


ì„¤ì¹˜ ë„ì¤‘ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤..


![1](/assets/img/2023-11-26-[AI]-Hugging-Face-ì™€-Transformers-ëª¨ë“ˆ.md/1.png)


ì•„ë§ˆ ìœˆë„ìš°ì˜ í´ë” ì´ë¦„ ê¸¸ì´ì¸ 256ë¥¼ ë„˜ì–´ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë°, ì´ ë¬¸ì œëŠ” ë‹¤ìŒê³¼ ê°™ì´ í•´ê²° í•˜ì˜€ë‹¤.


[https://dhniyeo.github.io/trouble shoot/2023/11/27/TroubleShoot-VisualStudio-Code-Tensorflow-ì„¤ì¹˜-ì˜¤ë¥˜-(ìœˆë„ìš°-í´ë”-ì´ë¦„-ê¸¸ì´-256-ì´ˆê³¼-ë¬¸ì œ)/](https://dhniyeo.github.io/trouble%20shoot/2023/11/27/TroubleShoot-VisualStudio-Code-Tensorflow-%EC%84%A4%EC%B9%98-%EC%98%A4%EB%A5%98-(%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%8F%B4%EB%8D%94-%EC%9D%B4%EB%A6%84-%EA%B8%B8%EC%9D%B4-256-%EC%B4%88%EA%B3%BC-%EB%AC%B8%EC%A0%9C)/)

1. Transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê°€ì¥ ê¸°ë³¸ ê°ì²´ëŠ”Â `pipeline()`Â í•¨ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°

(ì´ í•¨ìˆ˜ëŠ” ëª¨ë¸ì— ìˆì–´ì„œ í•„ìˆ˜ ê³¼ì •ì¸ ì „ì²˜ë¦¬ì™€ í›„ì²˜ë¦¬ ê³¼ì •ì„ ëª¨ë¸ê³¼ ì—°ê²°í•˜ê³ , ìš°ë¦¬ê°€ ë°”ë¡œ ì–´ë– í•œ í…ìŠ¤íŠ¸ ì…ë ¥ì„ ë„£ë“  ì›í•˜ëŠ” ë‹µì„ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤)


ex)



{% raw %}
```python
from transformers import pipeline

classifier = pipeline("sentiment-analysis")
print(classifier("I've been waiting for a HuggingFace course my whole life."))
```
{% endraw %}



ì—¬ê¸°ì„œÂ `classifier`Â ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ëª¨ë¸ì´ ë‹¤ìš´ë¡œë“œ ë˜ë©° ìºì‹±(caching)ì´ ì´ë£¨ì–´ì§€ë•Œë¬¸ì—, ì¬ì‹¤í–‰ ì‹œì—ëŠ” ìºì‹±ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê²Œ ë˜ì–´ ëª¨ë¸ì„ ë‹¤ì‹œ ë‹¤ìš´ë¡œë“œ í•˜ì§€ ì•ŠëŠ”ë‹¤.


ì‹¤í–‰ ì‹œ, ì•„ë˜ì™€ ê°™ì€ ê²½ê³ ê°€ ëœ° ìˆ˜ ìˆëŠ”ë°,


![2](/assets/img/2023-11-26-[AI]-Hugging-Face-ì™€-Transformers-ëª¨ë“ˆ.md/2.png)


piplineì— argumentì— íŠ¹ì • ëª¨ë¸ì„ ë„£ì–´ì£¼ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ, distilbert-base-uncased-finetuned-sst-2-english ëª¨ë¸ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.


ê·¸ë ‡ê¸° ë•Œë¬¸ì— Hugging Faceì— ìˆëŠ” íŠ¹ì • ëª¨ë¸ì„ ì´ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



{% raw %}
```python
from transformers import pipeline

model_id = "cardiffnlp/twitter-roberta-base-sentiment-latest"

sentiment_pipe = pipeline("sentiment-analysis", model=model_id)
print(sentiment_pipe('I love you'))
```
{% endraw %}



(cardiffnlp/twitter-roberta-base-sentiment-latest ë¼ëŠ” ëª¨ë¸ì„ ë‹¤ìš´ ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.)


Transformers ëª¨ë¸ì„ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì˜ ê³¼ì •ì„ ê±°ì¹˜ê²Œ ëœë‹¤.

	1. í…ìŠ¤íŠ¸ë¥¼ ëª¨ë¸ì´ ì´í•´ í•  ìˆ˜ ìˆê²Œ ì „ì²˜ë¦¬
	2. ì „ì²˜ë¦¬ ë°ì´í„°ë¥¼ ëª¨ë¸ì˜ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©
	3. ëª¨ë¸ì˜ ì˜ˆì¸¡ ê°’ì´ í›„ì²˜ë¦¬ë¥¼ ê±°ì³ ì‚¬ëŒì´ ì´í•´ ê°€ëŠ¥ í•œ í˜•íƒœë¡œ ë³€í™˜
1. í˜„ì¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒŒì´í”„ë¼ì¸ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- `feature-extraction`Â : íŠ¹ì§• ì¶”ì¶œ (í…ìŠ¤íŠ¸ì— ëŒ€í•œ ë²¡í„° í‘œí˜„ ì¶”ì¶œ)
- `fill-mask`Â : ë§ˆìŠ¤í¬ ì±„ìš°ê¸°
- `ner`Â : ê°œì²´ëª… ì¸ì‹ (named entity recognition)
- `question-answering`Â : ì§ˆì˜ ì‘ë‹µ
- `sentiment-analysis`Â : ê°ì • ë¶„ì„
- `summarization`Â : ìš”ì•½
- `text-generation`Â : í…ìŠ¤íŠ¸ ìƒì„±
- `translation`Â : ë²ˆì—­
- `zero-shot-classification`Â : ì œë¡œìƒ· ë¶„ë¥˜

---


ì°¸ê³  ì‚¬ì´íŠ¸


[https://huggingface.co/learn/nlp-course/ko/chapter1/3?fw=pt](https://huggingface.co/learn/nlp-course/ko/chapter1/3?fw=pt)

